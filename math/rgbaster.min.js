"use strict";var RGBaster={};(function(){var a=function(a,b){var c=document.createElement("canvas");return c.setAttribute("width",a),c.setAttribute("height",b),c.getContext("2d")},b=function(b,c){if("CANVAS"!=b.tagName){var d=new Image,e=b.src||b;"data:"!==e.substring(0,5)&&(d.crossOrigin="Anonymous"),d.onload=function(){var b=a(d.width,d.height);b.drawImage(d,0,0);var e=b.getImageData(0,0,d.width,d.height);c&&c(e.data)}}else{var f=b.getContext("2d"),g=f.getImageData(0,0,b.width,b.height);c&&c(g.data)}d.src=e},c=function(a){return["rgb(",a,")"].join("")},d=function(a){var b=[];for(var c in a)b.push(f(c,a[c]));return b.sort(function(c,a){return a.count-c.count}),b},e=function(a,b){if(a.length>b)return a.slice(0,b);for(var c=a.length-1;c<b-1;c++)a.push(f("0,0,0",0));return a},f=function(d,a){return{name:c(d),count:a}};RGBaster.colors=function(a,f){f=f||{};var g=f.exclude||[],h=f.paletteSize||10;b(a,function(a){for(var b={},j="",k=[],l=0;l<a.length;l+=4)(k[0]=a[l],k[1]=a[l+1],k[2]=a[l+2],j=k.join(","),-1===k.indexOf(void 0)&&0!==a[l+3])&&-1===g.indexOf(c(j))&&(j in b?++b[j]:b[j]=1);if(f.success){var m=e(d(b),h+1);f.success({dominant:m[0].name,secondary:m[1].name,palette:m.map(function(a){return a.name}).slice(1)})}})}})();