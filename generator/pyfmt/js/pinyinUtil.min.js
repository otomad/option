(function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=b(a):b(a)})("undefined"==typeof window?this:window,function(a){function b(a,b,c){b=b||"";for(var e=[""],f=[],g=0;g<a.length;g++){f=[];for(var h=a[g].split(b),l=0;l<h.length;l++)for(var m=0;m<e.length;m++)f.push(e[m]+(e[m]?c:"")+h[l]);e=f}return d(e)}function c(b,c,d,e){var f=a.pinyin_dict_polyphone,h=f[b];if(h){h=h.split(" ");for(var l=0;l<h.length;l++)c[l]=h[l]||c[l],e||(c[l]=g.removeTone(c[l]));return c.join(d)}for(var l=0;l<b.length;l++){h="";for(var m=0;m<7&&l+m<b.length&&!!/^[\u2E80-\u9FFF]+$/.test(b[l+m]);m++){h+=b[l+m];var n=f[h];if(n){n=n.split(" ");for(var o=0;o<=m;o++)n[o]&&(c[l+o]=e?n[o]:g.removeTone(n[o]));break}}}for(var l=0;l<c.length;l++)c[l]=c[l].replace(/ .*$/g,"");return c.join(d)}function d(a){for(var b,c=[],d={},e=0;e<a.length;e++)b=typeof a[e]+a[e],d[b]||(c.push(a[e]),d[b]=!0);return c}var e={ā:"a1",á:"a2",ǎ:"a3",à:"a4",ō:"o1",ó:"o2",ǒ:"o3",ò:"o4",ē:"e1",é:"e2",ě:"e3",è:"e4",ī:"i1",í:"i2",ǐ:"i3",ì:"i4",ū:"u1",ú:"u2",ǔ:"u3",ù:"u4",ü:"v0",ǖ:"v1",ǘ:"v2",ǚ:"v3",ǜ:"v4",ń:"n2",ň:"n3","":"m2"},f={},g={parseDict:function(){var b=String.fromCharCode;if(a.pinyin_dict_firstletter&&(f.firstletter=pinyin_dict_firstletter),a.pinyin_dict_notone)for(var c in f.notone={},f.py2hz=pinyin_dict_notone,pinyin_dict_notone)for(var d=pinyin_dict_notone[c],e=0,h=d.length;e<h;e++)f.notone[d[e]]||(f.notone[d[e]]=c);if(a.pinyin_dict_withtone){f.withtone={};for(var d=pinyin_dict_withtone.split(","),c=0,h=d.length;c<h;c++)f.withtone[b(c+19968)]=d[c];if(a.pinyin_dict_notone)f.py2hz=pinyin_dict_notone;else{for(var k,l,m=g.removeTone(pinyin_dict_withtone).split(","),n={},c=0,h=m.length;c<h;c++){l=b(c+19968),k=m[c].split(" ");for(var e=0;e<k.length;e++)n[k[e]]=(n[k[e]]||"")+l}f.py2hz=n}}},getPinyin:function(d,e,g,h){if(!d||/^ +$/g.test(d))return"";e=e==null?" ":e,g=!(g!=null)||g,h=h!=null&&h;var j=[];if(f.withtone){for(var k,l="",m=0,n=d.length;m<n;m++)k=f.withtone[d[m]],k?(!h&&(k=k.replace(/ .*$/g,"")),!g&&(k=this.removeTone(k)),l&&(j.push(l),l=""),j.push(k)):!d[m]||/^ +$/g.test(d[m])?l&&(j.push(l),l=""):l+=d[m];l&&(j.push(l),l="")}else if(f.notone){g&&console.warn("pinyin_dict_notone \u5B57\u5178\u6587\u4EF6\u4E0D\u652F\u6301\u58F0\u8C03\uFF01"),h&&console.warn("pinyin_dict_notone \u5B57\u5178\u6587\u4EF6\u4E0D\u652F\u6301\u591A\u97F3\u5B57\uFF01");for(var l="",m=0,n=d.length;m<n;m++){var o=d.charAt(m),k=f.notone[o];k?(l&&(j.push(l),l=""),j.push(k)):!o||/^ +$/g.test(o)?l&&(j.push(l),l=""):l+=o}l&&(j.push(l),l="")}else throw"\u62B1\u6B49\uFF0C\u672A\u627E\u5230\u5408\u9002\u7684\u62FC\u97F3\u5B57\u5178\u6587\u4EF6\uFF01";return h?a.pinyin_dict_polyphone?c(d,j,e,g):b(j," ",e):j.join(e)},getFirstLetter:function(a,c){if(c=null!=c&&c,!a||/^ +$/g.test(a))return"";if(f.firstletter){for(var e=[],g=0;g<a.length;g++){var h=a.charCodeAt(g),j=a.charAt(g);19968<=h&&40869>=h&&(j=f.firstletter.all.charAt(h-19968),c&&(j=f.firstletter.polyphone[h]||j)),e.push(j)}return c?b(e,"",""):e.join("")}var k=this.getPinyin(a," ",!1,c);k=k instanceof Array?k:[k];for(var e=[],g=0;g<k.length;g++)e.push(k[g].replace(/(^| )(\w)\w*/g,function(a,b,c){return c.toUpperCase()}));return c?d(e):e[0]},getHanzi:function(a){if(!f.py2hz)throw"\u62B1\u6B49\uFF0C\u672A\u627E\u5230\u5408\u9002\u7684\u62FC\u97F3\u5B57\u5178\u6587\u4EF6\uFF01";return f.py2hz[this.removeTone(a)]||""},getSameVoiceWord:function(a,b){return b=b||!1,this.getHanzi(this.getPinyin(a," ",!1))},removeTone:function(a){return a.replace(/[āáǎàōóǒòēéěèīíǐìūúǔùüǖǘǚǜńň]/g,function(a){return e[a][0]})},getTone:function(a){var b={};for(var c in e)b[e[c]]=c;return(a||"").replace(/[a-z]\d/g,function(a){return b[a]||a})}};g.parseDict(),g.dict=f,a.pinyinUtil=g});